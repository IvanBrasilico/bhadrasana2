{% extends "layout.html" %} {% block content %} {{super()}}
<div id="main" class="container-fluid">
    <div class="row col-sm-12">
        <form method="POST" id="formrvf" action="ovr">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="id" value="{{ oform.id.data }}"/>
            <div class="row">
                <div class="form-group">
                    <div class="col-sm-2">
                        <label for="numero">Número</label>
                    </div>
                    <div class="col-sm-2">
                        <label for="tipooperacao">Tipo de Operação</label>
                    </div>
                    <div class="col-sm-3">
                        <label for="numero">Recinto</label>
                    </div>
                    <div class="col-sm-5">
                        <label for="numero">Status</label>
                    </div>
                    <div class="col-sm-2">
                        {{ oform.numero(class='form-control')}}
                    </div>
                    <div class="col-sm-2">
                        {{ oform.tipooperacao(class='form-control')}}
                    </div>
                    <div class="col-sm-3">
                        {{ oform.recinto_id(class='form-control')}}
                    </div>
                    <div class="col-sm-2">
                        <div class="form-control">
                            <span class="{{ ovr.get_class() }}">
                                {{ ovr.get_fase() }}
                            </span>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="form-control">
                            <span class="{{ ovr.get_class() }}">
                                {{ ovr.tipoevento.nome }}
                            </span>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        CE Mercante
                        {{ oform.numeroCEmercante(class='form-control')}}
                    </div>
                    <div class="col-sm-12">
                        <div class="panel panel-info rounded-pill">
                            <div class="panel-heading rounded-pill">
                                {% if conhecimento %}
                                Embarcador: {{ conhecimento.embarcador }}<br>
                                Consignatário: {{ conhecimento.consignatario }}<br>
                                Descrição Mercadoria:{{ conhecimento.descricao }}<br>
                                Cubagem: {{ "%.2f"|format(conhecimento.cubagem|float) }}m³<br>
                                Contêineres: {% for container in containers %}
                                nº: {{container.codigoConteiner}} - {{"%.2f"|format(container.pesoBruto|float)}}kg
                                {% endfor %}<br>
                                NCMs: {% for ncm in ncms %}{{ ncm.identificacaoNCM }} {% endfor %}<br>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        Declaração: DUE, DUIMP, etc
                        {{ oform.numerodeclaracao(class='form-control')}}
                    </div>
                    <div class="col-sm-12">
                        Observações
                        {{ oform.observacoes(class='form-control') }}
                    </div>
                    <div class="col-sm-3">
                        <label for="adata">Dia da emissão</label>
                    </div>
                    <div class="col-sm-3">
                        <label for="ahora">Hora da emissão</label>
                    </div>
                    <div class="col-sm-6">
                        <label for="responsavel">Responsável</label>
                    </div>
                    <div class="col-sm-3">
                        {{ oform.adata(class='form-control') }}
                    </div>
                    <div class="col-sm-3">
                        {{ oform.ahora(class='form-control') }}
                    </div>
                    <div class="col-sm-3">
                        <div class="form-control ">
                            {{ ovr.responsavel.nome }}
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <button id="btn_responsavel" type="button" class="btn btn-warning form-control"
                                data-toggle="modal" data-target="#responsavel">
                            Atribuir responsável
                        </button>
                    </div>
                </div>
            </div>
            <div class="row col-sm-12">
                &nbsp;<br>
                <div class="col-sm-5">
                    <button class="btn btn-default btn-primary form-control" onclick="submit">
                        Salvar
                    </button>
                </div>
                <div class="col-sm-1">
                </div>
                <div class="col-sm-3">
                    <button id="btn_rvf" type="button" class="btn btn-primary btn-success form-control"
                            onclick="window.open('lista_rvfovr?ovr_id={{oform.id.data}}')">
                        Informar RVF
                    </button>
                </div>
                <div class="col-sm-3">
                    <button id="btn_tg" type="button" class="btn btn-primary btn-success form-control"
                            onclick="window.open('lista_tgovr?ovr_id={{oform.id.data}}')">
                        Termo de Guarda
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div class="row col-sm-12">
        &nbsp;<br>
    </div>
    <div class="row col-sm-12">
        <div class="col-sm-3">
            <h4>Lista de Movimentações</h4>
        </div>
        <div class="col-sm-6">
            <button id="btn_historico" type="button" class="btn btn-primary btn-warning form-control"
                    data-toggle="modal" data-target="#historico">Movimentar
            </button>
        </div>
        <div class="col-sm-3">
        </div>
        <div class="table-responsive table row col-sm-12">
            <table class="inlineTable table table-striped table-bordered table-hover table-condensed table-responsive"
                   cellspacing="0"
                   cellpadding="0">
                <tr>
                    <th>Tipo de Evento</th>
                    <th>Usuário</th>
                    <th>Detalhes</th>
                    <th>Data</th>
                </tr>
                {% for historico in listahistorico %}
                <tr>
                    <td align="center">
                        {{ historico.tipoevento.nome }}
                    </td>
                    <td align="center">
                        {{ historico.user_name }}
                    </td>
                    <td align="center">
                        {{ historico.motivo }}
                    </td>
                    <td align="center">
                        {{ historico.create_date }}
                    </td>
                </tr>
                {% endfor %}
                {% if not listahistorico %}
                <tr>
                    <td>Sem movimentações.</td>
                </tr>
                {% endif %}
            </table>
        </div>
    </div>
    <div class="row col-sm-12">
        &nbsp;<br>
    </div>
    <div class="row col-sm-12">
        <div class="col-sm-3">
            <h4>Lista de Processos</h4>
        </div>
        <div class="col-sm-6">
            <button id="btn_processo" type="button" class="btn btn-primary btn-warning form-control"
                    data-toggle="modal" data-target="#processo">Informar processo
            </button>
        </div>
        <div class="col-sm-3">
        </div>
        <div class="table-responsive table row col-sm-12">
            <table class="inlineTable table table-striped table-bordered table-hover table-condensed table-responsive"
                   cellspacing="0"
                   cellpadding="0">
                <tr>
                    <th>Tipo de Processo</th>
                    <th>Número</th>
                    <th>Data</th>
                </tr>
                {% for processo in processos %}
                <tr>
                    <td align="center">
                        {{ processo.tipoprocesso.descricao }}
                    </td>
                    <td align="center">
                        {{ processo.numero }}
                    </td>
                    <td align="center">
                        {{ processo.create_date }}
                    </td>
                </tr>
                {% endfor %}
                {% if not processos %}
                <tr>
                    <td>Sem processos.</td>
                </tr>
                {% endif %}
            </table>
        </div>
    </div>
</div>
<div id="bottom" class="row">
    AJNA - Receita Federal do Brasil 2017
</div>
<div class="modal fade" id="responsavel" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="ModalLabel0">Registra responsável pela ficha</h1>
            </div>
            <div class="modal-body">
                <form method="POST" action="responsavelovr" enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="ovr_id" value="{{ oform.id.data }}"/>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="tipoprocesso">Nome Responsável</label>
                        </div>
                        <div class="col-sm-9">
                            {{ responsavel_form.responsavel(class='form-control') }}
                        </div>
                    </div>
                    <input class="btn btn-primary" type="submit" value="Atribuir"/>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="historico" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="ModalLabel">Registra evento da OVR</h1>
            </div>
            <div class="modal-body">
                <form method="POST" action="movimentaovr" enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="ovr_id" value="{{ oform.id.data }}"/>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="tipoevento">Novo Status</label>
                        </div>
                        <div class="col-sm-9">
                            {{ historico_form.tipoevento_id(class='form-control') }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="motivo">Motivo</label>
                        </div>
                        <div class="col-sm-9">
                            {{ historico_form.motivo(class='form-control') }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            Usuário
                        </div>
                        <div class="col-sm-9">
                            {{ historico_form.user_name(class='form-control') }}
                        </div>
                    </div>
                    <input class="btn btn-primary" type="submit" value="Movimentar"/>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="processo" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title" id="ModalLabel2">Registra processo relativo à Ficha</h1>
            </div>
            <div class="modal-body">
                <form method="POST" action="processoovr" enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <input type="hidden" name="ovr_id" value="{{ oform.id.data }}"/>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="tipoprocesso">Tipo</label>
                        </div>
                        <div class="col-sm-9">
                            {{ processo_form.tipoprocesso_id(class='form-control') }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="motivo">Número</label>
                        </div>
                        <div class="col-sm-9">
                            {{ processo_form.numero(class='form-control') }}
                        </div>
                    </div>
                    <input class="btn btn-primary" type="submit" value="Registrar"/>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endblock %} {% block scripts %} {{super()}}
<script>
</script> {% endblock %}